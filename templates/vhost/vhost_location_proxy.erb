  location <%= location %> {
<% if @location_cfg_prepend -%><% location_cfg_prepend.each do |i| -%>
    <%= i %>;
<% end -%><% end -%>
<% if @proxy_cache %>    proxy_cache <%= proxy_cache %>;
<% end -%>
<% if @proxy_cache_bypass %>    proxy_cache_bypass <%= proxy_cache_bypass %>;
<% end -%>
<% if @proxy_ignore_headers %>    proxy_ignore_headers<% proxy_ignore_headers.each do |i| -%> <%= i %><% end -%>;
<% end -%>
<% if @proxy_cache_key %>    proxy_cache_key <%= proxy_cache_key %>;
<% end -%>
<% if @proxy_cache_valid %><% proxy_cache_valid.each do |i| -%>
    proxy_cache_valid <%= i %>;
<% end -%><% end -%>
    proxy_read_timeout <%= proxy_read_timeout %>;
    proxy_pass <%= proxy %>;
<% if @expires %>    expires <%= expires %>;<% end %>
    add_header BM-Cache-Status "$upstream_cache_status";
    add_header BM-Cache-Node "<%= hostname %>";
    add_header BM-Cache-BackendNode "$upstream_addr";
    add_header BM-Cache-BackendTime "$upstream_response_time";
<% if @location_cfg_append -%><% location_cfg_append.each do |i| -%>
    <%= i %>;
<% end -%><% end -%>
  }
